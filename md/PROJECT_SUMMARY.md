# Stock Analytics - –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

## ‚úÖ MVP –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–ê–õ–ò–ó–û–í–ê–ù

–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∞–∫—Ü–∏–π –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –±–∏—Ä–∂–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å—á—ë—Ç–æ–º –º–µ—Ç—Ä–∏–∫ –∏ REST API.

---

## üìä –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å MOEX
- ‚úÖ –¢–µ–∫—É—â–∏–µ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏ (—Ü–µ–Ω–∞, –ª–æ—Ç, —Ä–µ–∂–∏–º —Ç–æ—Ä–≥–æ–≤)
- ‚úÖ –î–∏–≤–∏–¥–µ–Ω–¥—ã TTM —á–µ—Ä–µ–∑ ISS API
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å–≤–µ—á–∏ (~400 –¥–Ω–µ–π, 5000+ —Å–≤–µ—á–µ–π)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —Ä–µ—Ç—Ä–∞–∏ (tenacity)
- ‚úÖ Rate limiting (0.4 —Å–µ–∫ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏)

### 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
- ‚úÖ SMA (20/50/200) —á–µ—Ä–µ–∑ pandas-ta
- ‚úÖ 52-–Ω–µ–¥–µ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (High/Low)
- ‚úÖ –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ —ç–∫—Å—Ç—Ä–µ–º—É–º–æ–≤
- ‚úÖ –î–∏–≤–∏–¥–µ–Ω–¥–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: `DY = (Div_TTM / Price) √ó 100%`

### 3. –¢–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- ‚úÖ `PRICE_ABOVE_SMA200` / `PRICE_BELOW_SMA200`
- ‚úÖ `SMA50_CROSS_UP_SMA200` (–∑–æ–ª–æ—Ç–æ–π –∫—Ä–µ—Å—Ç)
- ‚úÖ `SMA50_CROSS_DOWN_SMA200` (–∫—Ä–µ—Å—Ç —Å–º–µ—Ä—Ç–∏)
- ‚úÖ `DY_GT_TARGET` (–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å > 8%)
- ‚úÖ `VOL_SPIKE` (–≤—Å–ø–ª–µ—Å–∫ –æ–±—ä—ë–º–∞)

### 4. REST API (FastAPI)
- ‚úÖ 9 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ CORS support

### 5. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (APScheduler)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –≤ 19:10 –ø–æ –ú–æ—Å–∫–≤–µ
- ‚úÖ –†—É—á–Ω–æ–π —Ç—Ä–∏–≥–≥–µ—Ä —á–µ—Ä–µ–∑ API
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 6. –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ JSON —á–µ—Ä–µ–∑ orjson (–±—ã—Å—Ç—Ä–æ)
- ‚úÖ Parquet —á–µ—Ä–µ–∑ pyarrow (–∫–æ–º–ø–∞–∫—Ç–Ω–æ)
- ‚úÖ –ê—Ä—Ö–∏–≤ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤

### 7. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Loguru)
- ‚úÖ –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ (DEBUG/INFO/WARNING/ERROR)
- ‚úÖ JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ª–æ–≥–∏ (—Ç–∏–∫–µ—Ä, –æ–ø–µ—Ä–∞—Ü–∏—è)
- ‚úÖ –†–æ—Ç–∞—Ü–∏—è –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏—è

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç—á—ë—Ç (2025-10-07)

**–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:** 15 —Ç–∏–∫–µ—Ä–æ–≤ –∑–∞ 63.2 —Å–µ–∫—É–Ω–¥—ã  
**–£—Å–ø–µ—à–Ω–æ:** 13 (87%)  
**–° –æ—à–∏–±–∫–∞–º–∏:** 2 (YNDX, FIVE ‚Äî –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö)  
**–í—Å–µ–≥–æ —Å–∏–≥–Ω–∞–ª–æ–≤:** 22

### –¢–æ–ø-5 –ø–æ –¥–∏–≤–∏–¥–µ–Ω–¥–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏

| –¢–∏–∫–µ—Ä | –¶–µ–Ω–∞ | –î–∏–≤–∏–¥–µ–Ω–¥—ã | DY% | –°–∏–≥–Ω–∞–ª—ã |
|-------|------|-----------|-----|---------|
| VTBR | 67.76‚ÇΩ | 25.58‚ÇΩ | **37.75%** | PRICE_BELOW_SMA200, DY_GT_TARGET |
| MOEX | 162.20‚ÇΩ | 43.46‚ÇΩ | **26.79%** | PRICE_BELOW_SMA200, DY_GT_TARGET |
| MGNT | 3037‚ÇΩ | 560‚ÇΩ | **18.44%** | PRICE_BELOW_SMA200, DY_GT_TARGET |
| MTSS | 203‚ÇΩ | 35‚ÇΩ | **17.24%** | PRICE_BELOW_SMA200, DY_GT_TARGET |
| LKOH | 6123.5‚ÇΩ | 1055‚ÇΩ | **17.23%** | PRICE_ABOVE_SMA200, DY_GT_TARGET |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
stock_analytics/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ config/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (YAML + .env)
‚îÇ   ‚îú‚îÄ‚îÄ ingest/          # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö MOEX
‚îÇ   ‚îú‚îÄ‚îÄ process/         # –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ç—á—ë—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ store/           # –•—Ä–∞–Ω–∏–ª–∏—â–µ (JSON/Parquet)
‚îÇ   ‚îú‚îÄ‚îÄ api/             # FastAPI —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ scheduler/       # APScheduler –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ utils/           # –£—Ç–∏–ª–∏—Ç—ã (–ª–æ–≥–∏)
‚îÇ   ‚îú‚îÄ‚îÄ models.py        # Pydantic –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ main.py          # –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ analysis.json    # –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç—á—ë—Ç
‚îÇ   ‚îú‚îÄ‚îÄ reports/         # –ê—Ä—Ö–∏–≤ –æ—Ç—á—ë—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ raw/             # –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (Parquet)
‚îÇ   ‚îî‚îÄ‚îÄ logs/            # –õ–æ–≥–∏
‚îú‚îÄ‚îÄ docs/                # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ tests/               # 59 —Ç–µ—Å—Ç–æ–≤
‚îî‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

---

## üß™ –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

### –¢–µ—Å—Ç—ã
- **59 —Ç–µ—Å—Ç–æ–≤** (–≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- –ü–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- Unit + Integration —Ç–µ—Å—Ç—ã

### –¢–∏–ø–∏–∑–∞—Ü–∏—è
- Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
- Type hints –≤–µ–∑–¥–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Structured logging (JSON)
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ª–æ–≥–∏
- –†–æ—Ç–∞—Ü–∏—è –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏—è

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ
- `moexalgo` ‚Äî –¥–∞–Ω–Ω—ã–µ MOEX
- `pandas`, `pandas-ta` ‚Äî –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
- `fastapi`, `uvicorn` ‚Äî REST API
- `APScheduler` ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
- `loguru` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `pydantic` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è
- `orjson`, `pyarrow` ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- `pytest` ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- `httpx` ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

---

## üöÄ –ó–∞–ø—É—Å–∫

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞
pip install -r requirements.txt

# 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
copy .env.example .env

# 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞
python run_job_once.py

# 4. –ó–∞–ø—É—Å–∫ —Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º
python run_with_scheduler.py
```

### API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω

- üåê http://localhost:8000
- üìñ http://localhost:8000/api/docs

---

## üìã –ö—Ä–∏—Ç–µ—Ä–∏–∏ MVP (–≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã)

- ‚úÖ `analysis.json` –≥–µ–Ω–µ—Ä–∏—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Ç–∏–∫–µ—Ä–æ–≤
- ‚úÖ –°—á–∏—Ç–∞–Ω—ã SMA/52W/DY –∏ –±–∞–∑–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- ‚úÖ API –æ—Ç–¥–∞—ë—Ç `report/today`
- ‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–µ–ª–∞–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –ø—Ä–æ–≥–æ–Ω
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ—Ç—Ä–∞–∏ –∏ —Ç–∞–π–º–∏–Ω–≥–∏
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (59/59)

---

## üéØ Roadmap –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é

- ‚úÖ **–®–∞–≥ 0** ‚Äî –ö–∞—Ä–∫–∞—Å –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ **–®–∞–≥ 1** ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ **–®–∞–≥ 2** ‚Äî –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã (—Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ **–®–∞–≥ 3** ‚Äî –ò–Ω–∂–µ—Å—Ç —á–µ—Ä–µ–∑ moexalgo
- ‚úÖ **–®–∞–≥ 4** ‚Äî –•—Ä–∞–Ω–∏–ª–∏—â–µ
- ‚úÖ **–®–∞–≥ 5** ‚Äî –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Å–∏–≥–Ω–∞–ª—ã
- ‚úÖ **–®–∞–≥ 6** ‚Äî –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞
- ‚úÖ **–®–∞–≥ 7** ‚Äî API —Å–ª–æ–π (FastAPI)
- ‚úÖ **–®–∞–≥ 8** ‚Äî –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
- ‚úÖ **–®–∞–≥ 9** ‚Äî –õ–æ–≥–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](docs/quickstart.md)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](docs/configuration.md)
- [API](docs/api.md)
- [–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫](docs/scheduler.md)
- [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](docs/logging.md)
- [–°—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö](docs/README.md)

---

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

–ò–∑ `roadmap.md`:
- –ê–ª–µ—Ä—Ç—ã (Telegram/Email)
- HTML –æ—Ç—á—ë—Ç—ã
- –ê–Ω–∞–ª–∏–∑ –æ–±–ª–∏–≥–∞—Ü–∏–π
- –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (RSI, MACD, Bollinger Bands)
- Backtesting —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

---

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä 1: –ù–∞–π—Ç–∏ –≤—ã—Å–æ–∫–æ–¥–æ—Ö–æ–¥–Ω—ã–µ –∞–∫—Ü–∏–∏

```bash
curl http://localhost:8000/api/report/summary | jq '.data.high_dividend_tickers[:5]'
```

### –ü—Ä–∏–º–µ—Ä 2: –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ç—Ä–µ–Ω–¥—ã

```bash
# –ê–∫—Ü–∏–∏ –≤—ã—à–µ SMA200 (–±—ã—á–∏–π —Ç—Ä–µ–Ω–¥)
curl http://localhost:8000/api/report/today | jq '.data.by_symbol | 
  to_entries | 
  map(select(.value.signals | contains(["PRICE_ABOVE_SMA200"]))) | 
  map(.key)'
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

1. –ü–æ–ª—É—á–∏—Ç–µ –æ—Ç—á—ë—Ç: `GET /api/report/today`
2. –í—ã–±–µ—Ä–∏—Ç–µ –∞–∫—Ü–∏–∏ —Å `DY >= 8%` –∏ `PRICE_BELOW_SMA200`
3. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ—Ä—Ç—Ñ–µ–ª—å: `POST /api/portfolio`

---

## üéä –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** ~2 —á–∞—Å–∞  
**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~2500+  
**–¢–µ—Å—Ç–æ–≤:** 59  
**–ö–∞—á–µ—Å—Ç–≤–æ:** Production-ready

