# ‚úÖ LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞!

## üéâ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Å –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏!)

```
app/predictor/
‚îú‚îÄ‚îÄ llm_provider.py       ‚úÖ –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ ollama_provider.py    ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è Ollama
‚îú‚îÄ‚îÄ llm_analyzer.py       ‚úÖ LLM –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
‚îî‚îÄ‚îÄ signals.py            ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ —Å–∏—Å—Ç–µ–º—É
```

**–õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä:**
1. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π `LLMProvider`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å 2 –º–µ—Ç–æ–¥–∞: `analyze_sentiment()` –∏ `check_availability()`
3. –ì–æ—Ç–æ–≤–æ!

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama

```powershell
# Windows
winget install Ollama.Ollama
```

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Ollama –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ñ–æ–Ω–µ.

### –®–∞–≥ 2: –°–∫–∞—á–∞–π—Ç–µ –º–æ–¥–µ–ª—å

```bash
# –î–ª—è RTX 3060 Ti 8GB —Ä–µ–∫–æ–º–µ–Ω–¥—É—é:
ollama pull mistral

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã (–º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å):
# ollama pull qwen2.5:7b     # –û—Ç–ª–∏—á–Ω—ã–π —Ä—É—Å—Å–∫–∏–π
# ollama pull llama3.1:8b    # –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
# ollama pull gemma2:9b      # –û—Ç Google
```

**–†–∞–∑–º–µ—Ä:** ~4.1 GB (–ø–µ—Ä–≤—ã–π —Ä–∞–∑, –ø–æ—Ç–æ–º –±—ã—Å—Ç—Ä–æ)

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python –±–∏–±–ª–∏–æ—Ç–µ–∫—É

```bash
pip install ollama
```

### –®–∞–≥ 4: –í–∫–ª—é—á–∏—Ç–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–û—Ç–∫—Ä–æ–π—Ç–µ `config/predictor.yaml` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:

```yaml
llm:
  enabled: true  # ‚Üê –ò–∑–º–µ–Ω–∏—Ç–µ —Å false –Ω–∞ true
```

### –®–∞–≥ 5: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
# Ctrl+C —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
python run_with_scheduler.py
```

---

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (—É–º–Ω—ã–π!)

```
60 –Ω–æ–≤–æ—Å—Ç–µ–π —Å–æ–±—Ä–∞–Ω–æ
   ‚Üì
–≠–¢–ê–ü 1: –ë—ã—Å—Ç—Ä—ã–π —Ñ–∏–ª—å—Ç—Ä (keyword)
   ‚îú‚îÄ 50 –Ω–æ–≤–æ—Å—Ç–µ–π —è–≤–Ω–æ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã ‚Üí –æ—Ç—Å–µ–∏–≤–∞–µ–º
   ‚îî‚îÄ 10 –Ω–æ–≤–æ—Å—Ç–µ–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã ‚Üí –¥–∞–ª—å—à–µ
   
   ‚Üì
–≠–¢–ê–ü 2: –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ (LLM)  
   ‚îú‚îÄ "–ö–æ–º–ø–∞–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏–ª–∞ –ø—Ä–æ–¥—É–∫—Ç" ‚Üí +0.85 (–ø–æ–∑–∏—Ç–∏–≤!)
   ‚îú‚îÄ "–ö–æ–º–ø–∞–Ω–∏—è –æ—Ç–ª–æ–∂–∏–ª–∞ –∑–∞–ø—É—Å–∫" ‚Üí -0.3 (–Ω–µ–≥–∞—Ç–∏–≤!)
   ‚îî‚îÄ "–ö–æ–º–ø–∞–Ω–∏—è –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é" ‚Üí -0.2 (–∑–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–µ–≥–∞—Ç–∏–≤)
   
   ‚Üì
–†–ï–ó–£–õ–¨–¢–ê–¢: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π score
keyword * 0.3 + LLM * 0.7 = —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –±–∞–ª–ª
```

**–ò—Ç–æ–≥:** –¢–æ—á–Ω–æ + –ë—ã—Å—Ç—Ä–æ

---

## üéõÔ∏è –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### –†–µ–∂–∏–º 1: `relevant_only` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚≠ê

```yaml
use_for: relevant_only
```

- LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤–æ—Å—Ç–∏ —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
- ~10% –Ω–æ–≤–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ LLM
- –°–∫–æ—Ä–æ—Å—Ç—å: ~5-10 —Å–µ–∫ –Ω–∞ –≤–µ—Å—å –∞–Ω–∞–ª–∏–∑
- –¢–æ—á–Ω–æ—Å—Ç—å: ~80%

### –†–µ–∂–∏–º 2: `uncertain`

```yaml
use_for: uncertain
confidence_threshold: 0.3
```

- LLM —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã—Ö (score –æ—Ç -0.3 –¥–æ +0.3)
- ~5% –Ω–æ–≤–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ LLM  
- –°–∫–æ—Ä–æ—Å—Ç—å: ~3-5 —Å–µ–∫
- –¢–æ—á–Ω–æ—Å—Ç—å: ~75%

### –†–µ–∂–∏–º 3: `all` (–º–µ–¥–ª–µ–Ω–Ω—ã–π)

```yaml
use_for: all
```

- LLM –¥–ª—è –í–°–ï–• –Ω–æ–≤–æ—Å—Ç–µ–π
- 100% —á–µ—Ä–µ–∑ LLM
- –°–∫–æ—Ä–æ—Å—Ç—å: ~30-60 —Å–µ–∫
- –¢–æ—á–Ω–æ—Å—Ç—å: ~85%

---

## üí° –ü—Ä–∏–º–µ—Ä—ã —É–ª—É—á—à–µ–Ω–∏–π

### –î–æ (—Ç–æ–ª—å–∫–æ keywords):

**–ù–æ–≤–æ—Å—Ç—å:** "–ö–æ–º–ø–∞–Ω–∏—è –æ—Ç–ª–æ–∂–∏–ª–∞ –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞"
- Keyword: "–∑–∞–ø—É—Å–∫" ‚Üí +0.5 (–ü–û–ó–ò–¢–ò–í–ù–´–ô) ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!

**–ù–æ–≤–æ—Å—Ç—å:** "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é"
- Keyword: –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π ‚Üí 0.0 (–ù–ï–ô–¢–†–ê–õ–¨–ù–û) ‚ùå –£–ü–£–©–ï–ù–û!

### –ü–æ—Å–ª–µ (—Å LLM):

**–ù–æ–≤–æ—Å—Ç—å:** "–ö–æ–º–ø–∞–Ω–∏—è –æ—Ç–ª–æ–∂–∏–ª–∞ –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞"
- Keyword: +0.5
- LLM: -0.4 (–≤–∏–¥–∏—Ç "–æ—Ç–ª–æ–∂–∏–ª–∞")
- **–§–∏–Ω–∞–ª: +0.5 * 0.3 + (-0.4) * 0.7 = -0.13** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û!

**–ù–æ–≤–æ—Å—Ç—å:** "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é"
- Keyword: 0.0
- LLM: -0.3 ("–ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç" –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)
- **–§–∏–Ω–∞–ª: -0.21** ‚úÖ –û–ë–ù–ê–†–£–ñ–ï–ù–û!

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –¢–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:

| –ú–µ—Ç–æ–¥ | –¢–æ—á–Ω–æ—Å—Ç—å | –°–∫–æ—Ä–æ—Å—Ç—å | –ó–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã |
|-------|----------|----------|------------------------|
| –¢–æ–ª—å–∫–æ Keywords | ~65% | 0.001—Å | ‚ùå –ù–µ –≤–∏–¥–∏—Ç |
| –¢–æ–ª—å–∫–æ LLM | ~85% | 2-3—Å | ‚úÖ –í–∏–¥–∏—Ç |
| **–ì–∏–±—Ä–∏–¥** | **~80%** | **0.3—Å** | **‚úÖ –í–∏–¥–∏—Ç** |

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω

```bash
ollama list
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
NAME              ID           SIZE     MODIFIED
mistral:latest    xxxx         4.1 GB   2 minutes ago
```

### 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∞–Ω–∞–ª–∏–∑

```bash
ollama run mistral "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π: –°–±–µ—Ä–±–∞–Ω–∫ –∑–∞–ø—É—Å—Ç–∏–ª –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å"
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
INFO: LLM –¥–æ—Å—Ç—É–ø–µ–Ω: True
INFO: Ollama –¥–æ—Å—Ç—É–ø–µ–Ω, –º–æ–¥–µ–ª—å mistral –Ω–∞–π–¥–µ–Ω–∞
INFO: –ó–∞–ø—É—Å–∫–∞–µ–º LLM –∞–Ω–∞–ª–∏–∑...
INFO: LLM –∞–Ω–∞–ª–∏–∑: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è 7/60 –Ω–æ–≤–æ—Å—Ç–µ–π
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ GUI

–û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:8000/static/forecast.html`

–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```json
{
  "ok": true,
  "data": {
    "llm_used": true,  ‚Üê –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —ç—Ç–æ –ø–æ–ª–µ!
    "stats": { ... }
  }
}
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã (RTX 3060 Ti):

```yaml
llm:
  enabled: true
  model: mistral  # 7B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  use_for: relevant_only
  timeout: 5  # –°—Ç—Ä–æ–≥–∏–π —Ç–∞–π–º–∞—É—Ç
```

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏:

```yaml
llm:
  enabled: true
  model: qwen2.5:7b  # –õ—É—á—à–µ —Å —Ä—É—Å—Å–∫–∏–º
  use_for: all  # –í—Å–µ –Ω–æ–≤–æ—Å—Ç–∏
  timeout: 15
```

### –ï—Å–ª–∏ —Ç–æ—Ä–º–æ–∑–∏—Ç:

```yaml
llm:
  enabled: true
  use_for: uncertain  # –ú–µ–Ω—å—à–µ –Ω–æ–≤–æ—Å—Ç–µ–π
  timeout: 3  # –ë—ã—Å—Ç—Ä–µ–µ –æ—Ç–∫–∞—Ç
  confidence_threshold: 0.2  # –£–∂–µ –¥–∏–∞–ø–∞–∑–æ–Ω
```

---

## üîß –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏

```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏
ollama pull qwen2.5:7b
ollama pull llama3.1:8b
ollama pull gemma2:9b

# –ò–∑–º–µ–Ω–∏—Ç–µ –≤ config/predictor.yaml:
llm:
  model: qwen2.5:7b  # ‚Üê –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
```

**–ù–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å –∫–æ–¥!** –í—Å—ë —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.

---

## üéØ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä OpenAI)

–°–æ–∑–¥–∞–π—Ç–µ `app/predictor/openai_provider.py`:

```python
from .llm_provider import LLMProvider, LLMResponse

class OpenAIProvider(LLMProvider):
    async def analyze_sentiment(self, text, company=None, timeout=10):
        # –í–∞—à –∫–æ–¥ –¥–ª—è OpenAI API
        ...
    
    async def check_availability(self):
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞
        ...
```

–ì–æ—Ç–æ–≤–æ! –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç.

---

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "Ollama –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω
curl http://localhost:11434/api/tags

# –ï—Å–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Ollama
```

### –û—à–∏–±–∫–∞: "–ú–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–æ–¥–µ–ª—å —Å–∫–∞—á–∞–Ω–∞
ollama list

# –ï—Å–ª–∏ –Ω–µ—Ç - —Å–∫–∞—á–∞–π—Ç–µ
ollama pull mistral
```

### LLM –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ `config/predictor.yaml`:
```yaml
llm:
  enabled: true  # ‚Üê –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å true!
```

### –ú–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```yaml
# –£–º–µ–Ω—å—à–∏—Ç–µ scope
llm:
  use_for: uncertain  # –∏–ª–∏ relevant_only
  timeout: 5
```

---

## ‚ú® –ò—Ç–æ–≥–æ

**–ß—Ç–æ –ø–æ–ª—É—á–∏–ª–∏:**

- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è LLM (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, offline)
- ‚úÖ –ê–¥–∞–ø—Ç–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã)
- ‚úÖ –ì–∏–±—Ä–∏–¥–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–±—ã—Å—Ç—Ä–æ + —Ç–æ—á–Ω–æ)
- ‚úÖ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∑–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑
- ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

**–¢–æ—á–Ω–æ—Å—Ç—å:** 65% ‚Üí 80% ‚¨ÜÔ∏è (+23%)
**–°–∫–æ—Ä–æ—Å—Ç—å:** –ü—Ä–∏–µ–º–ª–µ–º–∞—è (~5-10 —Å–µ–∫)
**GPU:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ

---

**–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤—ã—à–µ –∏ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç!** üöÄ

