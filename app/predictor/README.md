# –ú–æ–¥—É–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –≤—Å–ø–ª–µ—Å–∫–æ–≤

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –≤—Å–ø–ª–µ—Å–∫–æ–≤ –∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞:
- RSS –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –ª–µ–Ω—Ç (–ò–Ω—Ç–µ—Ä—Ñ–∞–∫—Å, –†–ë–ö, –ö–æ–º–º–µ—Ä—Å–∞–Ω—Ç)
- –ü—É–±–ª–∏—á–Ω—ã—Ö API –≤–∞–∫–∞–Ω—Å–∏–π (hh.ru)
- –ö–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ sentiment analysis

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
app/predictor/
‚îú‚îÄ‚îÄ __init__.py        # –≠–∫—Å–ø–æ—Ä—Ç –≥–ª–∞–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
‚îú‚îÄ‚îÄ collector.py       # –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
‚îú‚îÄ‚îÄ analyzer.py        # NLP-–∞–Ω–∞–ª–∏–∑ –∏ scoring
‚îú‚îÄ‚îÄ signals.py         # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
‚îî‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install aiohttp beautifulsoup4 lxml
```

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
import asyncio
from app.predictor import generate_event_signals

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏
async def main():
    signal = await generate_event_signals(target_companies=['SBER', '–°–±–µ—Ä–±–∞–Ω–∫'])
    
    print(f"–£—Ä–æ–≤–µ–Ω—å —Å–∏–≥–Ω–∞–ª–∞: {signal['signal_level']}")
    print(f"–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: {signal['reason']}")
    print(f"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {signal['stats']}")

asyncio.run(main())
```

## üìä –£—Ä–æ–≤–Ω–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

| –£—Ä–æ–≤–µ–Ω—å | –û–ø–∏—Å–∞–Ω–∏–µ | –í–µ—Å –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö |
|---------|----------|---------------------|
| `HIGH_PROBABILITY` | –í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π | +1.5 |
| `MEDIUM_PROBABILITY` | –£–º–µ—Ä–µ–Ω–Ω–æ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Ñ–æ–Ω | +0.5 |
| `NEGATIVE_SIGNAL` | –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è | -1.0 |
| `LOW` | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö | 0.0 |

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª: `config/predictor.yaml`

```yaml
# –ò—Å—Ç–æ—á–Ω–∏–∫–∏ RSS –Ω–æ–≤–æ—Å—Ç–µ–π
news_sources:
  - https://www.interfax.ru/rss.asp
  - https://www.rbc.ru/rss/

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –≤–∞–∫–∞–Ω—Å–∏–π
use_vacancies: true

# –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
positive_keywords:
  - –∑–∞–ø—É—Å–∫
  - —Ñ—å—é—á–µ—Ä—Å
  - –Ω–æ–≤–∞—è —Å–µ–∫—Ü–∏—è
  - API

# –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
negative_keywords:
  - —Å–∞–Ω–∫—Ü–∏–∏
  - —É–±—ã—Ç–∫–∏
  - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞

# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å–µ–∫—É–Ω–¥—ã)
cache_ttl: 3600
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

–ú–æ–¥—É–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –¥–≤–∏–∂–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:

```python
from app.reco.engine import make_reco, get_event_signal
from app.reco.models import TickerSnapshot, RecoConfig

# –ü–æ–ª—É—á–∞–µ–º —Å–∏–≥–Ω–∞–ª –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
event_signal = get_event_signal('SBER')

# –°–æ–∑–¥–∞—ë–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é —Å —É—á—ë—Ç–æ–º —Å–∏–≥–Ω–∞–ª–∞
snapshot = TickerSnapshot(symbol='SBER', price=270.0, ...)
config = RecoConfig()

recommendation = make_reco(snapshot, config, event_signal=event_signal)
```

## üìù –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ê–Ω–∞–ª–∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π

```python
companies = ['SBER', 'GAZP', 'YNDX']
signal = await generate_event_signals(target_companies=companies)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if signal['signal_level'] == 'HIGH_PROBABILITY':
    print("‚ö° –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å–∏–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã!")
    print(f"–ü—Ä–∏—á–∏–Ω–∞: {signal['reason']}")
```

### –ü—Ä–∏–º–µ—Ä 2: –†–∞–±–æ—Ç–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π

```python
import json
from pathlib import Path

# –ß–∏—Ç–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤
history_file = Path('data/events_history.json')
if history_file.exists():
    with open(history_file, 'r', encoding='utf-8') as f:
        history = json.load(f)
    
    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç—Ä–µ–Ω–¥—ã
    recent_signals = history[-10:]
    positive_count = sum(1 for s in recent_signals 
                        if s['signal_level'] == 'HIGH_PROBABILITY')
    
    print(f"–ü–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∑–∞–ø—É—Å–∫–æ–≤: {positive_count}")
```

### –ü—Ä–∏–º–µ—Ä 3: –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```python
from app.predictor.config import PredictorConfig
from app.predictor.signals import EventSignalGenerator

# –°–æ–∑–¥–∞—ë–º –∫–∞—Å—Ç–æ–º–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
config = PredictorConfig(
    news_sources=['https://my-custom-rss.com/feed'],
    positive_keywords=['my', 'custom', 'keywords'],
    cache_ttl=7200  # 2 —á–∞—Å–∞
)

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
generator = EventSignalGenerator(config)
signal = await generator.generate_signal(['CUSTOM_TICKER'])
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
pytest tests/test_predictor.py -v
```

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
python test_predictor_demo.py
```

## üìà –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π

### HIGH_PROBABILITY

–í—ã–¥–∞—ë—Ç—Å—è –∫–æ–≥–¥–∞:
- 2+ –Ω–æ–≤–æ—Å—Ç–µ–π —Å –≤—ã—Å–æ–∫–∏–º –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º –±–∞–ª–ª–æ–º
- –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª > 0.4

### MEDIUM_PROBABILITY

–í—ã–¥–∞—ë—Ç—Å—è –∫–æ–≥–¥–∞:
- 1 HIGH + 2+ MEDIUM –Ω–æ–≤–æ—Å—Ç–∏
- 4+ MEDIUM –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª > 0.3
- 5+ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏ —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª > 0.2

### NEGATIVE_SIGNAL

–í—ã–¥–∞—ë—Ç—Å—è –∫–æ–≥–¥–∞:
- 3+ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–∏

### LOW

–í–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö

## üîß –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

```python
# –í config/predictor.yaml
news_sources:
  - https://your-new-source.com/rss
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤

```python
# –í config/predictor.yaml
positive_keywords:
  - –≤–∞—à–µ_–Ω–æ–≤–æ–µ_—Å–ª–æ–≤–æ
  - –µ—â—ë_–æ–¥–Ω–æ_—Å–ª–æ–≤–æ
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä

```python
from app.predictor.analyzer import NewsAnalyzer

class CustomAnalyzer(NewsAnalyzer):
    def analyze_item(self, item, target_companies=None):
        # –í–∞—à–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞
        result = super().analyze_item(item, target_companies)
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
        return result
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏

–õ–æ–≥–∏ –º–æ–¥—É–ª—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `data/logs/predictor.log`

### –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π

–ò—Å—Ç–æ—Ä–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `data/events_history.json` (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 –∑–∞–ø–∏—Å–µ–π)

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **Rate Limiting**: hh.ru API –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `requests_per_minute`)
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫—ç—à –Ω–∞ 1 —á–∞—Å –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
3. **–†—É—Å—Å–∫–∏–π —è–∑—ã–∫**: –ê–Ω–∞–ª–∏–∑ –∑–∞—Ç–æ—á–µ–Ω –ø–æ–¥ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏

## üéØ Roadmap

- [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ GPT-–º–æ–¥–µ–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- [ ] –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å "Event Forecast" –≤ GUI
- [ ] Webhook –¥–ª—è Telegram-–∫–∞–Ω–∞–ª–æ–≤
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
- [ ] Sentiment analysis –¥–ª—è –∑–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏

- `app/reco/` - –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π BUY/HOLD/SELL
- `app/ingest/` - –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å MOEX
- `app/process/` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏

## ü§ù –í–∫–ª–∞–¥

–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–æ–≤—ã—Ö —Ñ–∏—á:
1. –î–æ–±–∞–≤–ª—è–π—Ç–µ —Ç–µ—Å—Ç—ã –≤ `tests/test_predictor.py`
2. –û–±–Ω–æ–≤–ª—è–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
3. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å `app/reco/engine.py`

